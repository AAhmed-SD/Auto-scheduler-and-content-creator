{% extends "base.html" %}

{% block title %}Dashboard - Auto-Scheduler Admin{% endblock %}

{% block header %}Dashboard{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-6">
    <div class="flex items-center space-x-4">
        <select id="accountSelector" class="form-select min-w-[250px] rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500">
            <option value="">Select Project</option>
            <optgroup label="Active Projects">
                <option value="1">Nike - Sports & Lifestyle</option>
                <option value="2">Starbucks - Coffee & Beverages</option>
                <option value="3">Tesla - Automotive & Tech</option>
            </optgroup>
            <optgroup label="Pending Setup">
                <option value="4">Amazon - E-commerce</option>
                <option value="5">Apple - Technology</option>
            </optgroup>
        </select>
        <div class="flex items-center space-x-2">
            <span class="h-2 w-2 bg-green-500 rounded-full"></span>
            <span class="text-sm text-gray-600">Active Project</span>
        </div>
    </div>
    <div class="flex items-center space-x-3">
        <button class="px-4 py-2 text-sm text-gray-600 hover:text-gray-900">
            <i class="fas fa-cog mr-2"></i>Project Settings
        </button>
        <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
            <i class="fas fa-plus mr-2"></i>Add New Project
        </button>
    </div>
</div>

<!-- Project Quick Stats -->
<div class="bg-white rounded-lg shadow-sm border border-gray-100 p-4 mb-8">
    <div class="flex items-center justify-between">
        <div class="flex items-center space-x-4">
            <img src="{{ selected_account.logo }}" alt="Project Logo" class="h-12 w-12 rounded-lg">
            <div>
                <h2 class="text-xl font-semibold text-gray-800">{{ selected_account.name|default('Select a Project') }}</h2>
                <p class="text-sm text-gray-600">Last content posted 2 hours ago</p>
            </div>
        </div>
        <div class="flex items-center space-x-6">
            <div class="text-center">
                <p class="text-sm text-gray-600">Connected Platforms</p>
                <div class="flex items-center space-x-2 mt-1">
                    <i class="fab fa-instagram text-xl text-pink-600"></i>
                    <i class="fab fa-tiktok text-xl text-gray-900"></i>
                    <i class="fab fa-twitter text-xl text-blue-400"></i>
                    <i class="fab fa-linkedin text-xl text-blue-700"></i>
                </div>
            </div>
            <div class="text-center">
                <p class="text-sm text-gray-600">Content Queue</p>
                <p class="text-xl font-semibold text-gray-900">12</p>
            </div>
            <div class="text-center">
                <p class="text-sm text-gray-600">Monthly Budget</p>
                <p class="text-xl font-semibold text-gray-900">$2,500</p>
            </div>
        </div>
    </div>
</div>

<!-- Performance Metrics -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <!-- Total Reach -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6 transition-all hover:shadow-md">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-600">Total Reach</p>
                <h3 class="text-2xl font-bold text-gray-900 mt-1">2.4M</h3>
                <p class="text-sm text-green-600 mt-2 flex items-center">
                    <i class="fas fa-arrow-up mr-1"></i>
                    <span>18% vs last month</span>
                </p>
            </div>
            <div class="bg-blue-50 p-3 rounded-full">
                <i class="fas fa-globe text-blue-600 text-xl"></i>
            </div>
        </div>
    </div>

    <!-- Engagement Rate -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6 transition-all hover:shadow-md">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-600">Engagement Rate</p>
                <h3 class="text-2xl font-bold text-gray-900 mt-1">4.8%</h3>
                <p class="text-sm text-green-600 mt-2 flex items-center">
                    <i class="fas fa-arrow-up mr-1"></i>
                    <span>2.1% vs industry avg</span>
                </p>
            </div>
            <div class="bg-green-50 p-3 rounded-full">
                <i class="fas fa-chart-line text-green-600 text-xl"></i>
            </div>
        </div>
    </div>

    <!-- Content Performance -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6 transition-all hover:shadow-md">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-600">Best Performing</p>
                <h3 class="text-2xl font-bold text-gray-900 mt-1">Video</h3>
                <p class="text-sm text-gray-600 mt-2 flex items-center">
                    <span>+85% engagement</span>
                </p>
            </div>
            <div class="bg-purple-50 p-3 rounded-full">
                <i class="fas fa-video text-purple-600 text-xl"></i>
            </div>
        </div>
    </div>

    <!-- ROI -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6 transition-all hover:shadow-md">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-600">ROI</p>
                <h3 class="text-2xl font-bold text-gray-900 mt-1">3.2x</h3>
                <p class="text-sm text-green-600 mt-2 flex items-center">
                    <i class="fas fa-arrow-up mr-1"></i>
                    <span>0.8x vs target</span>
                </p>
            </div>
            <div class="bg-red-50 p-3 rounded-full">
                <i class="fas fa-chart-pie text-red-600 text-xl"></i>
            </div>
        </div>
    </div>
</div>

<!-- Charts Section -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
    <!-- Platform Performance -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6">
        <div class="flex items-center justify-between mb-6">
            <h4 class="text-lg font-semibold text-gray-900">Platform Performance</h4>
            <div class="flex items-center space-x-2">
                <button class="px-3 py-1 text-sm text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200">Week</button>
                <button class="px-3 py-1 text-sm text-white bg-indigo-600 rounded-md hover:bg-indigo-700">Month</button>
                <button class="px-3 py-1 text-sm text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200">Year</button>
            </div>
        </div>
        <div class="h-80 relative">
            <canvas id="engagementChart"></canvas>
        </div>
    </div>

    <!-- Content Distribution -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6">
        <div class="flex items-center justify-between mb-6">
            <h4 class="text-lg font-semibold text-gray-900">Content Mix</h4>
            <div class="flex items-center space-x-2">
                <button class="px-3 py-1 text-sm text-gray-600 hover:text-indigo-600">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
        <div class="h-80 relative">
            <canvas id="contentChart"></canvas>
        </div>
    </div>
</div>

<!-- Content Calendar -->
<div class="bg-white rounded-lg shadow-sm border border-gray-100">
    <div class="p-6 border-b border-gray-100">
        <div class="flex items-center justify-between">
            <h4 class="text-lg font-semibold text-gray-900">Upcoming Content</h4>
            <div class="flex items-center space-x-3">
                <button class="text-sm text-indigo-600 hover:text-indigo-700">View Calendar</button>
                <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 text-sm">
                    <i class="fas fa-plus mr-2"></i>Schedule Content
                </button>
            </div>
        </div>
    </div>
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Content</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Platform</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Schedule</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for content in upcoming_content %}
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="h-10 w-10 flex-shrink-0">
                                <img class="h-10 w-10 rounded-lg object-cover" src="{{ content.preview_image }}" alt="">
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">{{ content.title }}</div>
                                <div class="text-sm text-gray-500">{{ content.type }}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center space-x-2">
                            {% if content.platform == 'instagram' %}
                            <i class="fab fa-instagram text-pink-600"></i>
                            {% elif content.platform == 'tiktok' %}
                            <i class="fab fa-tiktok text-gray-900"></i>
                            {% elif content.platform == 'twitter' %}
                            <i class="fab fa-twitter text-blue-400"></i>
                            {% elif content.platform == 'linkedin' %}
                            <i class="fab fa-linkedin text-blue-700"></i>
                            {% endif %}
                            <span class="text-sm text-gray-900">{{ content.platform|title }}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        {{ content.schedule_time }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs font-medium rounded-full 
                            {% if content.status == 'scheduled' %}
                                bg-green-100 text-green-800
                            {% elif content.status == 'draft' %}
                                bg-gray-100 text-gray-800
                            {% elif content.status == 'in_review' %}
                                bg-yellow-100 text-yellow-800
                            {% endif %}
                        ">
                            {{ content.status|title }}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <div class="flex items-center space-x-3">
                            <button class="text-gray-600 hover:text-indigo-600">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="text-gray-600 hover:text-red-600">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% block extra_js %}
<script>
    // Project selector functionality
    document.getElementById('accountSelector').addEventListener('change', function(e) {
        const projectId = e.target.value;
        if (projectId) {
            window.location.href = `/dashboard?project=${projectId}`;
        }
    });

    // Chart configurations
    const chartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                position: 'bottom',
                labels: {
                    padding: 20,
                    usePointStyle: true,
                    font: {
                        size: 12
                    }
                }
            }
        }
    };

    // Platform Performance Chart
    const engagementCtx = document.getElementById('engagementChart').getContext('2d');
    new Chart(engagementCtx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [
                {
                    label: 'Instagram',
                    data: [65, 59, 80, 81, 56, 55],
                    borderColor: '#E1306C',
                    tension: 0.4
                },
                {
                    label: 'TikTok',
                    data: [28, 48, 40, 19, 86, 27],
                    borderColor: '#000000',
                    tension: 0.4
                },
                {
                    label: 'Twitter',
                    data: [45, 25, 32, 67, 49, 54],
                    borderColor: '#1DA1F2',
                    tension: 0.4
                }
            ]
        },
        options: chartOptions
    });

    // Content Distribution Chart
    const contentCtx = document.getElementById('contentChart').getContext('2d');
    new Chart(contentCtx, {
        type: 'doughnut',
        data: {
            labels: ['Video', 'Image', 'Story', 'Text'],
            datasets: [{
                data: [45, 25, 20, 10],
                backgroundColor: ['#818CF8', '#34D399', '#F472B6', '#FBBF24']
            }]
        },
        options: {
            ...chartOptions,
            cutout: '70%'
        }
    });
</script>
{% endblock %}

{% endblock %} 